┌─────────────────────────────────────────────────────────────────────────────┐
│                              製造業SaaS全体像                                 │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────┐   ┌─────────────┐   ┌─────────────┐                       │
│  │   工場A     │   │   工場B     │   │   工場C     │  ← 顧客工場           │
│  │ ┌─────────┐ │   │ ┌─────────┐ │   │ ┌─────────┐ │                       │
│  │ │Edge K8s │ │   │ │Edge K8s │ │   │ │Edge K8s │ │  ← エッジクラスタ     │
│  │ │(K3s等)  │ │   │ │(K3s等)  │ │   │ │(K3s等)  │ │                       │
│  │ └────┬────┘ │   │ └────┬────┘ │   │ └────┬────┘ │                       │
│  │      │      │   │      │      │   │      │      │                       │
│  │  センサー群  │   │  センサー群  │   │  センサー群  │  ← IoTデバイス        │
│  │  PLC/SCADA  │   │  PLC/SCADA  │   │  PLC/SCADA  │                       │
│  └──────┼──────┘   └──────┼──────┘   └──────┼──────┘                       │
│         │                 │                 │                              │
│         └────────────────┼─────────────────┘                              │
│                          │ MQTT/HTTPS                                      │
│                          ▼                                                 │
│  ┌───────────────────────────────────────────────────────────────────┐    │
│  │                    Cloud Kubernetes Cluster                        │    │
│  │  ┌─────────────────────────────────────────────────────────────┐  │    │
│  │  │                     Ingress Layer                            │  │    │
│  │  │   NGINX Ingress / AWS ALB / Cloud Load Balancer             │  │    │
│  │  └─────────────────────────────────────────────────────────────┘  │    │
│  │                              │                                     │    │
│  │  ┌───────────────────────────┴───────────────────────────┐       │    │
│  │  │                   API Gateway                          │       │    │
│  │  │            (Kong / Ambassador / Istio)                 │       │    │
│  │  └───────────────────────────────────────────────────────┘       │    │
│  │                              │                                     │    │
│  │  ┌─────────────────────────────────────────────────────────────┐  │    │
│  │  │              Application Services (Namespace per Tenant)     │  │    │
│  │  │  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐           │  │    │
│  │  │  │ IoT     │ │ Analytics│ │ MES     │ │ Quality │           │  │    │
│  │  │  │ Ingestion│ │ Service │ │ Service │ │ Service │           │  │    │
│  │  │  └─────────┘ └─────────┘ └─────────┘ └─────────┘           │  │    │
│  │  └─────────────────────────────────────────────────────────────┘  │    │
│  │                              │                                     │    │
│  │  ┌─────────────────────────────────────────────────────────────┐  │    │
│  │  │                    Data Layer                                │  │    │
│  │  │  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐           │  │    │
│  │  │  │TimeSeries│ │ Message │ │   RDB   │ │  Cache  │           │  │    │
│  │  │  │(InfluxDB)│ │ (Kafka) │ │(Postgres)│ │ (Redis) │           │  │    │
│  │  │  └─────────┘ └─────────┘ └─────────┘ └─────────┘           │  │    │
│  │  └─────────────────────────────────────────────────────────────┘  │    │
│  └───────────────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────────────────┘
